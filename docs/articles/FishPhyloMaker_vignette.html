<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Using FishPhyloMaker to build phylogenies for bony fishes â€¢ FishPhyloMaker</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Using FishPhyloMaker to build phylogenies for bony fishes">
<meta property="og:description" content="FishPhyloMaker">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">FishPhyloMaker</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1.2</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/FishPhyloMaker_vignette.html">Using FishPhyloMaker to build phylogenies for bony fishes</a>
    </li>
    <li>
      <a href="../articles/whichFishAdd_vignette.html">How to find for species that must be added?</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="FishPhyloMaker_vignette_files/header-attrs-2.3/header-attrs.js"></script><script src="FishPhyloMaker_vignette_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Using FishPhyloMaker to build phylogenies for bony fishes</h1>
            
            <h4 class="date">2021-04-01</h4>
      
      
      <div class="hidden name"><code>FishPhyloMaker_vignette.Rmd</code></div>

    </div>

    
    
<p>In this article we will show how to obtain a phylogeny for a pool of species using FishPhyloMaker package. First of all, we need to install and read FishPhyloMaker package, that can be made using the following code:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">devtools</span><span class="fu">::</span><span class="fu"><a href="https://devtools.r-lib.org//reference/remote-reexports.html">install_github</a></span><span class="op">(</span><span class="st">"GabrielNakamura/FishPhyloMaker"</span>, ref <span class="op">=</span> <span class="st">"main"</span><span class="op">)</span></code></pre></div>
<p>We will use a data base that contain fish species from rivers and streams of neotropical region, this data are present in the package and can be easily accessed by typing:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">FishPhyloMaker</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="st">"fish_SAmerica"</span><span class="op">)</span></code></pre></div>
<p><code>fish_SAmerica</code> correspond to a data frame containing the occurrence of 679 fish species at 37 basins in the neotropical region. To obtain a phylogenetic tree for these species we first need to format these data accordingly to enter in <code>FishPhyloMaker</code> function, that correspond to a data frame with three column containing the taxonomic information of each one of the 679 species. To obtain this data we will use the function <code>FishTaxaMaker</code> that finds for each name of species present in the <code>fish_SAmerica</code> data and checks if these names are found in <a href="%22https://www.fishbase.se/search.php%22">Fishbase</a>. Note that not all species was found in Fishbase data, so, the user must type manually, through an interactive process, the name of the Family and the Order of the species that was not found. The names must be typed sequentially, as in the following code.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">taxon_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/FishTaxaMaker.html">FishTaxaMaker</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">fish_SAmerica</span><span class="op">)</span>
<span class="va">Loricariidae</span>
<span class="va">Siluriformes</span>
<span class="va">Anostomidae</span> 
<span class="va">Characiformes</span>
<span class="va">Anostomidae</span> 
<span class="va">Characiformes</span>
<span class="va">Anostomidae</span> 
<span class="va">Characiformes</span>
<span class="va">Serrasalmidae</span>
<span class="va">Characiformes</span>
<span class="va">Auchenipteridae</span>
<span class="va">Siluriformes</span>
<span class="va">Auchenipteridae</span>
<span class="va">Siluriformes</span>
<span class="va">Auchenipteridae</span>
<span class="va">Siluriformes</span></code></pre></div>
<p>This function will return a data frame with three columns and the same number of species present in <code>fish_SAmerica</code> data, and now this data can be used in <code>FishPhyloMaker</code> function to generate the phylogenetic tree for these species. In this example we will set the argument return.insertions = TRUE, since we want to know at which level of insertion each species was inserted in the process. Like <code>FishTaxaMaker</code> function, <code>FishPhyloMaker</code> also have a interactive process of insertion in which the user must inform at which genus or family the species must be inserted in the mega-tree. There are three options:</p>
<ol style="list-style-type: decimal">
<li><p><strong>Insert the species near to a given genus/family</strong>: To insert the species near to a specific genus/family, the user must type the name of the genus (or family) at which the species must be inserted;</p></li>
<li><p><strong>Insert the species between two genus/families</strong>: To insert the species between two different genus or families, the user must type the names of the two genus/families separated by a blank space;</p></li>
<li><p><strong>Insert at the root of the family/order</strong>: To insert the species at the node that corresponds to the family (or order), the user must type the name of the family.</p></li>
</ol>
<p>These three options are shown in the following code:</p>
<p><em>NOTE</em> - The function can take several minutes to run depending on the number of species that must be inserted.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1"></a>phylo_fish_SAmerica &lt;-<span class="st"> </span><span class="kw">FishPhyloMaker</span>(<span class="dt">data =</span> taxon_data, <span class="dt">return.insertions =</span> T)</span>
<span id="cb4-2"><a href="#cb4-2"></a>Serrasalmidae</span>
<span id="cb4-3"><a href="#cb4-3"></a>Acanthicus</span>
<span id="cb4-4"><a href="#cb4-4"></a>Schizodon</span>
<span id="cb4-5"><a href="#cb4-5"></a>Liosomadoras</span>
<span id="cb4-6"><a href="#cb4-6"></a>Hemiancistrus</span>
<span id="cb4-7"><a href="#cb4-7"></a>Ctenolucius</span>
<span id="cb4-8"><a href="#cb4-8"></a>Roeboexodon Exodon</span>
<span id="cb4-9"><a href="#cb4-9"></a>Leporinus</span>
<span id="cb4-10"><a href="#cb4-10"></a>Gymnotus</span>
<span id="cb4-11"><a href="#cb4-11"></a>Loricariichthys</span>
<span id="cb4-12"><a href="#cb4-12"></a>Anostomus</span>
<span id="cb4-13"><a href="#cb4-13"></a>Furcodontichthys</span>
<span id="cb4-14"><a href="#cb4-14"></a>Lasiancistrus</span>
<span id="cb4-15"><a href="#cb4-15"></a>Leporinus</span>
<span id="cb4-16"><a href="#cb4-16"></a>Schizodon Hypomasticus</span>
<span id="cb4-17"><a href="#cb4-17"></a>Batrochoglanis</span>
<span id="cb4-18"><a href="#cb4-18"></a>Pseudolithoxus</span>
<span id="cb4-19"><a href="#cb4-19"></a>Leporinus</span>
<span id="cb4-20"><a href="#cb4-20"></a>Anodus</span>
<span id="cb4-21"><a href="#cb4-21"></a>Paralonchurus</span>
<span id="cb4-22"><a href="#cb4-22"></a>Pachypops</span>
<span id="cb4-23"><a href="#cb4-23"></a>Vandellia Paravandellia</span>
<span id="cb4-24"><a href="#cb4-24"></a>Pachyurus</span>
<span id="cb4-25"><a href="#cb4-25"></a>Anostomus</span>
<span id="cb4-26"><a href="#cb4-26"></a>Sternarchorhamphus</span>
<span id="cb4-27"><a href="#cb4-27"></a>Vandellia</span>
<span id="cb4-28"><a href="#cb4-28"></a>Odontognathus</span>
<span id="cb4-29"><a href="#cb4-29"></a>Exallodontus</span>
<span id="cb4-30"><a href="#cb4-30"></a>Myleus</span>
<span id="cb4-31"><a href="#cb4-31"></a>Gnathodolus</span>
<span id="cb4-32"><a href="#cb4-32"></a>Trachelyopterus</span>
<span id="cb4-33"><a href="#cb4-33"></a>Hemiodontichthys</span>
<span id="cb4-34"><a href="#cb4-34"></a>Rhinelepis</span>
<span id="cb4-35"><a href="#cb4-35"></a>Pseudohemiodon</span>
<span id="cb4-36"><a href="#cb4-36"></a>Schizodon</span>
<span id="cb4-37"><a href="#cb4-37"></a>Gnathodolus</span>
<span id="cb4-38"><a href="#cb4-38"></a>Panaque Panaqolus</span>
<span id="cb4-39"><a href="#cb4-39"></a>Pseudacanthicus Leporacanthicus</span>
<span id="cb4-40"><a href="#cb4-40"></a>Hypopomidae</span>
<span id="cb4-41"><a href="#cb4-41"></a>Sternarchogiton</span>
<span id="cb4-42"><a href="#cb4-42"></a>Platyurosternarchus</span>
<span id="cb4-43"><a href="#cb4-43"></a>Gymnocorymbus</span>
<span id="cb4-44"><a href="#cb4-44"></a>Schizodon</span>
<span id="cb4-45"><a href="#cb4-45"></a>Synbranchidae</span>
<span id="cb4-46"><a href="#cb4-46"></a>Ageneiosus</span>
<span id="cb4-47"><a href="#cb4-47"></a>Asterophysus</span>
<span id="cb4-48"><a href="#cb4-48"></a>Trachelyopterus</span>
<span id="cb4-49"><a href="#cb4-49"></a>Ageneiosus</span></code></pre></div>
<p>The result is a list containing two objects, a phylogenetic tree and a dataframe indicating at which level each species was inserted in the phylogeny. We can directly plot the phylogenetic tree</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">phylo_fish_SAmerica</span><span class="op">$</span><span class="va">Phylogeny</span>, cex <span class="op">=</span> <span class="fl">0.3</span><span class="op">)</span></code></pre></div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

      </div>

</div>



      <footer><div class="copyright">
  <p>Developed by Gabriel Nakamura, Aline Richter, Bruno Soares.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
