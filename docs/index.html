<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>An R Package to Generate Phylogeny for a Local List of Fish Species â€¢ FishPhyloMaker</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="bootstrap-toc.css">
<script src="bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="pkgdown.css" rel="stylesheet">
<script src="pkgdown.js"></script><meta property="og:title" content="An R Package to Generate Phylogeny for a Local List of Fish Species">
<meta property="og:description" content="FishPhyloMaker provides an alternative to facilitate the construction of a phylogeny for fish species from a list of species
   or a community matrix using as a backbone the phylogenetic tree proposed by Rabosky (2018).">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-home">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="index.html">FishPhyloMaker</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1.2</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="articles/FishPhyloMaker_vignette.html">Using FishPhyloMaker to build phylogenies for bony fishes</a>
    </li>
    <li>
      <a href="articles/whichFishAdd_vignette.html">How to know which species must be added to phylogeny?</a>
    </li>
  </ul>
</li>
<li>
  <a href="news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="contents col-md-9">

<p><img src="reference/figures/Logo_FishPhyloMaker.png" alt="fish logo" width="200px" align="right"></p>
<div id="fishphylomaker" class="section level1">
<div class="page-header"><h1 class="hasAnchor">
<a href="#fishphylomaker" class="anchor"></a>FishPhyloMaker</h1></div>
<p><a href="https://cran.r-project.org/package=FishPhyloMaker"><img src="https://www.r-pkg.org/badges/version/FishPhyloMaker" alt="CRAN_Status_Badge"></a></p>
<p><a href="https://codecov.io/gh/GabrielNakamura/FishPhyloMaker"><img src="https://codecov.io/gh/GabrielNakamura/FishPhyloMaker/branch/master/graph/badge.svg" alt="codecov"></a></p>
<p><a href="https://choosealicense.com/licenses/mit/"><img src="https://img.shields.io/github/license/mashape/apistatus.svg" alt="license"></a></p>
<p><strong>Making phylogenies for a local pool of fish species</strong></p>
<p>The FishPhyloMaker package has as the core function <code>FishPhyloMaker</code>, that works by downloading the <a href="https://fishtreeoflife.org/">most inclusive phylogeny of bony fishes</a> provided by <a href="https://onlinelibrary.wiley.com/doi/10.1111/jbi.13839">Rabosky (2018)</a> and edit this phylogeny, in a sequential way by replacing and dropping the fish species of the original phylogeny to obtain a phylogenetic tree containing only the desired species specified in a data frame. The procedure starts by adding all species of fish that already present any Genus in the tree (Congeneric species). For species that do not present any representative of the same Genus, the function finds out for all species of the same family, if not present any species in the tree the search is performed for species of the same Order. By an interactively procedure, the user must specify which Genus from that family (or families in orders) in the tree the species to be inserted is most related. The function returns a phylo object containing the phylogeny of species provide in data argument and a data frame (if argument <code>return.insertions = TRUE</code>) containing all species with an character indicating at which level the species was added in the tree. There are four possible categories in which species can be tagged regarding their order of insertion:</p>
<ul>
<li>
<strong>Present_in_tree</strong> the species was already present in the original tree;</li>
<li>
<strong>Congeneric_insertion</strong> species inserted as a sister species of the same genus presented in the tree;</li>
<li>
<strong>Congeneric_insertion_roundFamily</strong> species inserted as a sister species of the same genus presented in the tree, but that were added after a species of local pool of the same genus be inserted in the tree;</li>
<li>
<strong>Family_insertion</strong> if not found any congeneric species, the species will be inserted near to, or between genus of the same family presented in the tree. The user can also insert the species in the base of the family;</li>
<li>
<strong>Order_insertion</strong> if not found any genus of the same family of the species that must be inserted, the species will be inserted near to a given family, between two families or at the node that corresponds to the Order of this species;</li>
<li>
<strong>Not_inserted</strong> if species was not inserted in any of the previous steps, it will not be inserted in the final tree;</li>
</ul>
<p>The user must provide to <code>FishPhyloMaker</code> function a data frame that present the following format:</p>
<table class="table">
<thead><tr class="header">
<th align="center">s</th>
<th align="center">f</th>
<th align="center">o</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="center">G_sp1</td>
<td align="center">Family1</td>
<td align="center">Order1</td>
</tr>
<tr class="even">
<td align="center">G_sp2</td>
<td align="center">Family2</td>
<td align="center">Order2</td>
</tr>
<tr class="odd">
<td align="center">G_sp3</td>
<td align="center">Family3</td>
<td align="center">Order3</td>
</tr>
</tbody>
</table>
<p>This table can be done mannually or by passing to <code>FishTaxaMaker</code> a list of species or a community data matrix with species names in columns.</p>
<p>To install the package the user must type:</p>
<pre class="{.r}"><code><a href="https://devtools.r-lib.org//reference/remote-reexports.html">devtools::install_github("GabrielNakamura/FishPhyloMaker", ref = "main")</a></code></pre>
<p>To run an example the user can load a data set contained in the package:</p>
<pre class="{.r}"><code><a href="https://rdrr.io/r/base/library.html">library(FishPhyloMaker)
data(neotropical_comm)
data_comm &lt;- neotropical_comm[, -c(1, 2)] # removing latitude and longitude</a></code></pre>
<p>This data set comprises the occurrence of 59 fish species that occur in headwater streams of Parana and Paraguai river Basins, in Brazil. The coordinates of these streams are presented in the two first columns of this data set.</p>
<p>First the user must obtain the data necessary to enter in <code>FishPhyloMaker</code> using <code>FishTaxaMaker</code></p>
<pre class="{.r}"><code>taxon_data &lt;- FishTaxaMaker(data_comm)
Loricariidae
Siluriformes</code></pre>
<p><code>FishTaxaMaker</code> finds in <a href="https://www.fishbase.se/search.php">Fishbase</a> for the family and the order of species provided in data argument. If any species was not find in Fishbase, the user will be asked to type the Family and the Order of this species manually. In the case of this data set, species <em>Curculionichthys inseperatus</em> was not found in Fishbase, so we inform manually the family (Loricariidae) and order (Siluriformes) of this species. This function can also be usefull to check possible mispelling errors in the name of species.</p>
<p>Finally run <code>FishPhyloMaker</code></p>
<pre class="{.r}"><code>res_phylo &lt;- FishPhyloMaker(data = taxon_data, return.insertions = TRUE)
Hisonotus 
Synbranchidae </code></pre>
<p>The species are inserted in a sequential procedure. Those species with any congeneric representatives will be printed in the console jointly with a list of Genus in which the user must choose. The user have three options:</p>
<ol>
<li>Insert <strong>near to a specific Genus</strong>, then the user must type the name of this Genus;</li>
<li>Insert <strong>between to Genus</strong>, then the user must type the names of these two Genus separated by a white space;</li>
<li>Insert <strong>at the node that correspond to the Family</strong> of the species being inserted. Then, the user must type the name of the Family.</li>
</ol>
<p>The output has two objects, a phylogenetic treefor the local pool of fish species, and can be directly plot</p>
<pre class="{.r}"><code><a href="https://rdrr.io/r/graphics/plot.default.html">plot(res_phylo$Phylogeny, cex = 0.7)</a></code></pre>
<p>And a data frame indicating at which level the species of local pool was inserted (one of the six categories detailed above).</p>
<pre class="{.r}"><code>res_phylo$Insertions_data</code></pre>
<p>For more details and updates in package functioning see <a href="https://gabrielnakamura.github.io/FishPhyloMaker/">FishPhyloMaker web page</a></p>
</div>

  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <div class="license">
<h2>License</h2>
<ul class="list-unstyled">
<li><a href="LICENSE.html">Full license</a></li>
<li><small><a href="https://opensource.org/licenses/mit-license.php">MIT</a> + file <a href="LICENSE-text.html">LICENSE</a></small></li>
</ul>
</div>
<div class="developers">
<h2>Developers</h2>
<ul class="list-unstyled">
<li>Gabriel Nakamura <br><small class="roles"> Author, maintainer </small> <a href="https://orcid.org/0000-0002-5144-5312" target="orcid.widget" aria-label="ORCID"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a> </li>
<li>Aline Richter <br><small class="roles"> Author </small>  </li>
<li>Bruno Soares <br><small class="roles"> Author </small>  </li>
</ul>
</div>

  </div>
</div>


      <footer><div class="copyright">
  <p>Developed by Gabriel Nakamura, Aline Richter, Bruno Soares.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
